var Const={};Const.FSO=new ActiveXObject("Scripting.FileSystemObject");Const.WSHELL=WScript.CreateObject("WScript.Shell");Const.SHELLAPP=WScript.CreateObject("Shell.Application");Const.INITIAL_CURRENT_DIRECTORY=Const.WSHELL.CurrentDirectory;Const.WINDOW_STYLE_NORMAL=1;Const.WINDOW_STYLE_MIN=2;Const.WINDOW_STYLE_MAX=3;Const.IOMODE_FORREADING=1;Const.IOMODE_FORWRITING=2;Const.IOMODE_FORAPPENDING=8;Const.LOG_EVENT_TYPE_SUCCESS=0;Const.LOG_EVENT_TYPE_ERROR=1;Const.LOG_EVENT_TYPE_WARNING=2;Const.LOG_EVENT_TYPE_INFORMATION=4;Const.LOG_EVENT_TYPE_AUDIT_SUCCESS=8;Const.LOG_EVENT_TYPE_AUDIT_FAILURE=16;Const.BUTTON_TYPE_OK_ONLY=0;Const.BUTTON_TYPE_OK_CANCEL=1;Const.BUTTON_TYPE_STOP_RETRY_IGNORE=2;Const.BUTTON_TYPE_YES_NO_CANCEL=3;Const.BUTTON_TYPE_YES_NO=4;Const.BUTTON_TYPE_RETRY_CANCEL=5;Const.ICON_TYPE_STOP=16;Const.ICON_TYPE_QUESTION=32;Const.ICON_TYPE_EXCLAMATION=48;Const.ICON_TYPE_INFO=64;Const.BUTTON_VALUE_OK=1;Const.BUTTON_VALUE_CANCEL=2;Const.BUTTON_VALUE_STOP=3;Const.BUTTON_VALUE_RETRY=4;Const.BUTTON_VALUE_IGNORE=5;Const.BUTTON_VALUE_YES=6;Const.BUTTON_VALUE_NO=7;var sleep=function(a){WScript.Sleep(a)};var sleepif=function(c,b,a){while(true){if(b(a)){return true}sleep(c)}};var print=function(a){WScript.Echo(a)};var exit=function(a){var b=a||0;WScript.Quit(b)};var isFunction=function(a){return(typeof a=="function")};var getComputerName=function(){return Const.WSHELL.ExpandEnvironmentStrings("%COMPUTERNAME%")};var isWScriptRunning=function(){return/wscript\.exe$/i.test(WScript.FullName)};var sendKeys=function(d,a){var c=a||1;for(var b=0;b<a;b++){Const.WSHELL.Sendkeys(d)}return this};var getEnv=function(a){return Const.WSHELL.ExpandEnvironmentStrings("%"+a+"%")};var osShutdown=function(a){if(a===null){a=0}Process.exec("shutdown",["-s","-t",a],0,false)};var osReboot=function(b,a){var c=["-r","-t"];if(b===null){b=0}c.push(b);if(a!==null){c.push(a)}Process.exec("shutdown",c,0,false)};var createShortcut=function(c,b){var a=Const.WSHELL.CreateShortcut(c);a.TargetPath=b;a.Save()};var popup=function(e,b,h,f,d){var g=b||0;var i=h||"Windows Script Host";var c=f||Const.BUTTON_TYPE_OK_ONLY;var a=d||Const.ICON_TYPE_INFO;return Const.WSHELL.popup(e,g,i,c+a)};var SpecialFolders={};SpecialFolders.getAllUsersDesktop=function(){return Const.WSHELL.SpecialFolders("AllUsersDesktop")};SpecialFolders.getAllUsersStartMenu=function(){return Const.WSHELL.SpecialFolders("AllUsersStartMenu")};SpecialFolders.getAllUsersPrograms=function(){return Const.WSHELL.SpecialFolders("AllUsersPrograms")};SpecialFolders.getAllUsersStartup=function(){return Const.WSHELL.SpecialFolders("AllUsersStartup")};SpecialFolders.getDesktop=function(){return Const.WSHELL.SpecialFolders("Desktop")};SpecialFolders.getFavorites=function(){return Const.WSHELL.SpecialFolders("Favorites")};SpecialFolders.getFonts=function(){return Const.WSHELL.SpecialFolders("Fonts")};SpecialFolders.getMyDocuments=function(){return Const.WSHELL.SpecialFolders("MyDocuments")};SpecialFolders.getNetHood=function(){return Const.WSHELL.SpecialFolders("NetHood")};SpecialFolders.getPrintHood=function(){return Const.WSHELL.SpecialFolders("PrintHood")};SpecialFolders.getPrograms=function(){return Const.WSHELL.SpecialFolders("Programs")};SpecialFolders.getRecent=function(){return Const.WSHELL.SpecialFolders("Recent")};SpecialFolders.getSendTo=function(){return Const.WSHELL.SpecialFolders("SendTo")};SpecialFolders.getStartMenu=function(){return Const.WSHELL.SpecialFolders("StartMenu")};SpecialFolders.getStartup=function(){return Const.WSHELL.SpecialFolders("Startup")};SpecialFolders.getTemplates=function(){return Const.WSHELL.SpecialFolders("Templates")};Array.prototype.each=function(c){var a=[];for(var b=0;b<this.length;b++){a.push(c(this[b]))}return a};Date.prototype.getYYYYMMDD=function(){var c=this.getFullYear();var b=this.getMonth()+1;var a=this.getDate();if(b<10){b="0"+b}if(a<10){a="0"+a}return c+b+a};Date.prototype.getYYYYMMDDHH24MISS=function(){var f=this.getFullYear();var e=this.getMonth()+1;var a=this.getDate();var d=this.getHours();var b=this.getMinutes();var c=this.getSeconds();if(e<10){e="0"+e}if(a<10){a="0"+a}if(d<10){d="0"+d}if(b<10){b="0"+b}if(c<10){c="0"+c}return f+e+a+d+b+c};Date.prototype.getFormattedDate=function(){var f=this.getFullYear();var e=this.getMonth()+1;var a=this.getDate();var d=this.getHours();var b=this.getMinutes();var c=this.getSeconds();if(e<10){e="0"+e}if(a<10){a="0"+a}if(d<10){d="0"+d}if(b<10){b="0"+b}if(c<10){c="0"+c}return f+"/"+e+"/"+a+" "+d+":"+b+":"+c};String.prototype.trim=function(){var a=this.valueOf();return(a||"").replace(/^\s+|\s+$/g,"")};var File=function(a,b){this.path=a;this.mode=b;if(this.mode==="w"){this.ts=Const.FSO.CreateTextFile(this.path)}else{if(this.mode==="a"){if(File.exist(this.path)){this.ts=Const.FSO.OpenTextFile(this.path,Const.IOMODE_FORAPPENDING)}else{this.ts=Const.FSO.CreateTextFile(this.path)}}else{this.ts=Const.FSO.OpenTextFile(this.path,Const.IOMODE_FORREADING)}}};File.open=function(b,d,c){var a=new File(b,d);if(c){try{c(a)}finally{a.close()}}else{return a}};File.rename=function(b,a){if(Const.FSO.FolderExists(b)){Const.FSO.MoveFolder(b,a)}else{if(Const.FSO.FileExists(b)){Const.FSO.MoveFile(b,a)}else{throw new Error(-1,"File Not Found: "+b)}}};File.copy=function(b,a){if(Const.FSO.FolderExists(b)){Const.FSO.CopyFolder(b,a)}else{if(Const.FSO.FileExists(b)){Const.FSO.CopyFile(b,a)}else{throw new Error(-1,"File Not Found: "+b)}}};File.exist=function(a){if(Const.FSO.FolderExists(a)){return true}else{if(Const.FSO.FileExists(a)){return true}else{return false}}};File.unlink=function(b,a){if(!a){a=false}if(Const.FSO.FolderExists(b)){Const.FSO.DeleteFolder(b,a)}else{if(Const.FSO.FileExists(b)){Const.FSO.DeleteFile(b,a)}else{throw new Error(-1,"File Not Found: "+b)}}};File.size=function(a){if(Const.FSO.FolderExists(a)){return Const.FSO.GetFolder(a).Size}else{if(Const.FSO.FileExists(a)){return Const.FSO.GetFile(a).Size}else{throw new Error(-1,"File Not Found: "+a)}}};File.realpath=function(a,b){if(!b){b=Dir.getwd()}Dir.cd(b,function(c){realpath=Const.FSO.GetAbsolutePathName(a)});return realpath};File.extname=function(a){var b=Const.FSO.GetExtensionName(a);if(b===""){return b}else{return"."+b}};File.basename=function(a){var b=Const.FSO.GetFile(a);return b.Name};File.createTemporaryFile=function(b){var a=SpecialFolders.getMyDocuments()+"\\"+new Date().getYYYYMMDDHH24MISS();File.open(a,"w",function(c){b(c)});if(File.exist(a)){File.unlink(a)}};File.prototype={each:function(a){while(!this.ts.AtEndOfStream){a(this.ts.ReadLine())}},puts:function(a){this.ts.WriteLine(a)},close:function(){this.ts.Close()},getPath:function(){return this.path}};var Dir=function(a){if(!Dir.exist(a)){throw new Error(a+" not found or is not directory.")}this.path=a};Dir.getwd=function(){return Const.WSHELL.CurrentDirectory};Dir.pwd=Dir.getwd;Dir.chdir=function(b,c){if(!b){b=Const.INITIAL_CURRENT_DIRECTORY}else{if(!File.exist(b)){throw new Error(-1,"Path Not Found: "+b)}}if(c){var a=Dir.getwd();Const.WSHELL.CurrentDirectory=b;c(b);Const.WSHELL.CurrentDirectory=a}else{Const.WSHELL.CurrentDirectory=b}};Dir.mkdir=function(a){Const.FSO.CreateFolder(a);return new Dir(a)};Dir.getParentDir=function(a){return Const.FSO.GetParentFolderName(a)};Dir.open=function(b,c){if(c){var a=new Dir(b);c(a)}else{return new Dir(b)}};Dir.exist=function(a){return Const.FSO.FolderExists(a)};Dir.entries=function(c){var b=new Dir(c);var a=[];b.each(function(d){a.push(d)});return a};Dir.find=function(e,d,f){var b=new Dir(e);var a=[];var c=function(g){if(d===undefined||g.match(d)){if(f){f(g)}else{a.push(g)}}};b.each(function(j){if(Dir.exist(j)){var g=Dir.find(j,d,f);for(var h=0;h<g.length;h++){c(g[h])}}else{c(j)}});return a};Dir.prototype={getParentDir:function(){return Dir.getParentDir(this.path)},each:function(d){var c=Const.FSO.GetFolder(this.path);var b=new Enumerator(c.SubFolders);for(;!b.atEnd();b.moveNext()){d(b.item().Path)}var a=new Enumerator(c.Files);for(;!a.atEnd();a.moveNext()){d(a.item().Path)}}};var HTTP=function(b,a){this.host=b;this.port=a||DEFAULT_PORT_NUMBER};HTTP.DEFAULT_PORT_NUMBER=80;HTTP.start=function(c,a,d){var b=new HTTP(c,a);if(d){d(b)}else{return b}};HTTP.get=function(a,e,c){var b=c||DEFAULT_PORT_NUMBER;var d=new HTTP(a,c);return d.get(e)};HTTP.get_print=function(a,c,b){print(HTTP.get(a,c,b))};HTTP.prototype={get:function(a,e,c){if(e===undefined){e=[]}var b=new ActiveXObject("Microsoft.XMLHTTP");b.open("GET","http://"+this.host+":"+this.port+a,false);for(var d in e){b.setRequestHeader(d,e[d])}b.send();if(b.readyState==4){if(b.status==200){if(c){c(b.responseText)}else{return b.responseText}}else{throw new Error(b.statusText)}}}};var FTP={};FTP.MODE_ASCII=1;FTP.MODE_BINARY=2;FTP.get=function(c,b,a,e,d,f){File.createTemporaryFile(function(g){g.puts("open "+c);g.puts(b);g.puts(a);g.puts("cd "+d);if(e===FTP.MODE_ASCII){g.puts("ascii")}else{g.puts("binary")}g.puts("get "+f);g.puts("bye");Process.exec("ftp",['-s:"'+g.getPath()+'"'],Const.WINDOW_STYLE_MIN,true)})};FTP.put=function(c,b,a,e,d,f){File.createTemporaryFile(function(g){g.puts("open "+c);g.puts(b);g.puts(a);g.puts("cd "+d);if(e===FTP.MODE_ASCII){g.puts("ascii")}else{g.puts("binary")}g.puts("put "+f);g.puts("bye");Process.exec("ftp",['-s:"'+g.getPath()+'"'],Const.WINDOW_STYLE_MIN,true)})};var Clipboard=function(){this._ie=new ActiveXObject("InternetExplorer.Application");this._ie.navigate("about:blank");while(this._ie.Busy){sleep(10)}this._ie.Visible=false;this._textarea=this._ie.document.createElement("textarea");this._ie.document.body.appendChild(this._textarea);this._textarea.focus();this._closed=false};Clipboard.open=function(b){if(!isFunction(b)){return new Clipboard()}try{var a=new Clipboard();b(a)}finally{if(a!=null){a.close()}}};Clipboard.prototype={set:function(a){if(this._closed){return}this._textarea.innerText=a;this._ie.execWB(17,0);this._ie.execWB(12,0)},get:function(){if(this._closed){return}this._textarea.innerText="";this._ie.execWB(13,0);return this._textarea.innerText},close:function(){this._ie.Quit();this._closed=true}};var KeySender=function(a){Const.WSHELL.AppActivate(a)};KeySender.prototype={sendKeys:function(b,a){sendKeys(b,a);return this},sendJapaneseKeys:function(b,a){Clipboard.open(function(d){for(var c=0;c<a;c++){d.set(b);sendKeys("^v")}});return this},sendKeyWithShift:function(b,a){sendKeys("+"+b,a);return this},sendKeyWithControl:function(b,a){sendKeys("^"+b,a);return this},sendKeyWithAlt:function(b,a){sendKeys("%"+b,a);return this},sendBackspace:function(b,a){sendKeys("{BACKSPACE}",a);return this},sendBreak:function(b,a){sendKeys("{BREAK}",a);return this},sendCapsLock:function(b,a){sendKeys("{CAPSLOCK}",a);return this},sendDelete:function(b,a){sendKeys("{DELETE}",a);return this},sendDownArrow:function(b,a){sendKeys("{DOWN}",a);return this},sendEnd:function(b,a){sendKeys("{END}",a);return this},sendEnter:function(a){sendKeys("{ENTER}",a);return this},sendEsc:function(a){sendKeys("{ESC}",a);return this},sendHelp:function(a){sendKeys("{HELP}",a);return this},sendHome:function(a){sendKeys("{HOME}",a);return this},sendInsert:function(a){sendKeys("{INSERT}",a);return this},sendLeftArrow:function(a){sendKeys("{LEFT}",a);return this},sendNumLock:function(a){sendKeys("{NUMLOCK}",a);return this},sendPageDown:function(a){sendKeys("{PGDN}",a);return this},sendPageUp:function(a){sendKeys("{PGUP}",a);return this},sendPrintScreen:function(a){sendKeys("{PRTSC}",a);return this},sendRightArrow:function(a){sendKeys("{RIGHT}",a);return this},sendScrollLock:function(a){sendKeys("{SCROLLLOCK}",a);return this},sendTab:function(a){sendKeys("{TAB}",a);return this},sendUpArrow:function(a){sendKeys("{UP}",a);return this},sendF1:function(a){sendKeys("{F1}",a);return this},sendF2:function(a){sendKeys("{F2}",a);return this},sendF3:function(a){sendKeys("{F3}",a);return this},sendF4:function(a){sendKeys("{F4}",a);return this},sendF5:function(a){sendKeys("{F5}",a);return this},sendF6:function(a){sendKeys("{F6}",a);return this},sendF7:function(a){sendKeys("{F7}",a);return this},sendF8:function(a){sendKeys("{F8}",a);return this},sendF9:function(a){sendKeys("{F9}",a);return this},sendF10:function(a){sendKeys("{F10}",a);return this},sendF11:function(a){sendKeys("{F11}",a);return this},sendF12:function(a){sendKeys("{F12}",a);return this},sendF13:function(a){sendKeys("{F13}",a);return this},sendF14:function(a){sendKeys("{F14}",a);return this},sendF15:function(a){sendKeys("{F15}",a);return this},sendF16:function(a){sendKeys("{F16}",a);return this}};var Process={};Process.exec=function(e,c,d,b){if(!c){c=[]}if(!d){d=Const.WINDOW_STYLE_NORMAL}if(b===undefined){b=true}var a=e+" "+c.join(" ");Const.WSHELL.Run(a,d,b)};var Registry={};Registry.REG_TYPE_REG_SZ="REG_SZ";Registry.REG_TYPE_REG_DWORD="REG_DWORD";Registry.REG_TYPE_REG_BINARY="REG_BINARY";Registry.REG_TYPE_REG_EXPAND_SZ="REG_EXPAND_SZ";Registry.regRead=function(a){return Const.WSHELL.RegRead(a)};Registry.regWrite=function(a,d,b){var c=b||Registry.REG_TYPE_REG_SZ;Const.WSHELL.RegWrite(a,d,c)};Registry.regDelete=function(a){Const.WSHELL.RegDelete(a)};var Excel=function(a){this.path=a;if(!File.exist(a)){throw new Error(-1,"File Not Found: "+a)}this.excelObj=new ActiveXObject("Excel.Application");this.workbookObj=this.excelObj.Workbooks.Open(a)};Excel.open=function(a,c){if(!isFunction(c)){return new Excel(a)}try{var b=new Excel(a);c(b)}finally{if(b!=null){b.quit()}}};Excel.openReadonly=function(a,c){if(!isFunction(c)){return new Excel(a)}try{var b=new Excel(a);c(b)}finally{if(b!=null){b.quitDiscardChanges()}}};Excel.prototype={each:function(b){var a=new Enumerator(this.workbookObj.Sheets);for(;!a.atEnd();a.moveNext()){b(new ExcelSheet(a.item()))}},getSheetByName:function(b){var a;this.each(function(c){if(c.getName()===b){a=c}});return a},getSheetByIndex:function(b){var a;var c=0;this.each(function(d){if(c===b){a=d}c++});return a},addSheet:function(c,b){var a=this.getSheetByIndex(b).getRawObject();var d=this.workbookObj.Sheets.Add(null,a,1,null);d.Name=c;return new ExcelSheet(d)},save:function(){this.workbookObj.Save()},saveAs:function(a){this.workbookObj.SaveAs(a)},quitDiscardChanges:function(){this.workbookObj.Close(false);this.excelObj.Quit()},quit:function(){this.workbookObj.Close();this.excelObj.Quit()}};var ExcelSheet=function(a){this.sheetObj=a};ExcelSheet.prototype={getName:function(){return this.sheetObj.Name},setValue:function(a,c,b){this.sheetObj.Cells(a,c).Value=b},getValue:function(a,b){return this.sheetObj.Cells(a,b).Value},getRawObject:function(){return this.sheetObj}};AdoOracleConnection=function(c,b,a){this.con=new ActiveXObject("ADODB.Connection");this.con.Open("Provider=MSDAORA;Data Source="+c+";",b,a)};AdoOracleConnection.open=function(d,b,a,c){if(!isFunction(c)){return new AdoOracleConnection(d,b,a)}try{var e=new AdoOracleConnection(d,b,a);c(e)}finally{if(e!=null){e.close()}}};AdoOracleConnection.prototype={executeQuery:function(h){try{var c=this.con.Execute(h);var d=new Enumerator(c.Fields);var a=[];while(!c.EOF){var b={};for(d.moveFirst();!d.atEnd();d.moveNext()){var g=d.item();b[g.Name]=g.Value}a.push(b);c.MoveNext()}return a}catch(f){throw f}finally{if(c){c.Close()}}},close:function(){this.con.Close()}};var LogEvent={};LogEvent.success=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_SUCCESS,a)};LogEvent.error=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_ERROR,a)};LogEvent.warning=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_WARNING,a)};LogEvent.information=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_INFORMATION,a)};LogEvent.auditSuccess=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_AUDIT_SUCCESS,a)};LogEvent.auditFailure=function(a){Const.WSHELL.LogEvent(Const.LOG_EVENT_TYPE_AUDIT_FAILURE,a)};var Shell={};Shell.open=function(a){Const.SHELLAPP.Open(a)};Shell.serviceStart=function(a,b){myIsPersistent=b||false;return Const.SHELLAPP.ServiceStart(a,myIsPersistent)};Shell.serviceStop=function(a,b){myIsPersistent=b||false;return Const.SHELLAPP.ServiceStop(a,myIsPersistent)};